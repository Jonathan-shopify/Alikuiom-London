class VariantSelects extends HTMLElement{constructor(){super(),this.addEventListener("change",this.onVariantChange)}onVariantChange(){this.updateOptions(),this.updateMasterId(),this.toggleAddButton(!0,"",!1),this.updatePickupAvailability(),this.updateVariantStatuses(),this.currentVariant?(this.updateMedia(),this.updateVariantInput(),this.renderProductInfo(),document.querySelectorAll(".template-product").length&&!this.closest("#content_quickview")&&this.updateURL()):(this.toggleAddButton(!0,"",!0),this.setUnavailable())}updateOptions(){this.options=Array.from(this.querySelectorAll("select"),(t=>t.value))}updateMasterId(){this.currentVariant=this.getVariantData().find((t=>!t.options.map(((t,e)=>this.options[e]===t)).includes(!1)))}updateMedia(){if(!this.currentVariant||!this.currentVariant?.featured_media)return;const t=document.querySelector(`[data-media-id="${this.dataset.section}-${this.currentVariant.featured_media.id}"]`);if(!t)return;const e=t.parentElement,a=document.querySelectorAll(".proFeaturedImage .item");for(var r=0;r<a.length;r++)a[r].classList.remove("act");t.classList.add("act"),window.setTimeout((()=>{e.scroll(0,0)}))}updateURL(){this.currentVariant&&"false"!==this.dataset.updateUrl&&window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`)}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}, #product-form-installment-${this.dataset.section}`).forEach((t=>{const e=t.querySelector('input[name="id"]');e.value=this.currentVariant.id,e.dispatchEvent(new Event("change",{bubbles:!0}))}))}updateVariantStatuses(){const t=this.variantData.filter((t=>this.querySelector(":checked").value===t.option1)),e=[...this.querySelectorAll(".product-form__input")];e.forEach(((a,r)=>{if(0===r)return;const i=[...a.querySelectorAll('input[type="radio"], option')],n=e[r-1].querySelector(":checked").value,s=t.filter((t=>t.available&&t[`option${r}`]===n)).map((t=>t[`option${r+1}`]));this.setInputAvailability(i,s)}))}setInputAvailability(t,e){t.forEach((t=>{e.includes(t.getAttribute("value"))?t.innerText=t.getAttribute("value"):t.innerText=window.variantStrings.unavailable_with_option.replace("[value]",t.getAttribute("value"))}))}updatePickupAvailability(){const t=document.querySelector("pickup-availability");t&&(this.currentVariant&&this.currentVariant.available?t.fetchAvailability(this.currentVariant.id):(t.removeAttribute("available"),t.innerHTML=""))}renderProductInfo(){const t=this.currentVariant.id;this.dataset.originalSection?this.dataset.originalSection:this.dataset.section;fetch(`${this.dataset.url}?variant=${t}&section_id=${this.dataset.originalSection?this.dataset.originalSection:this.dataset.section}`).then((t=>t.text())).then((t=>{const e=`ProductPrice-${this.dataset.section}`,a=(new DOMParser).parseFromString(t,"text/html"),r=document.getElementById(e),i=a.getElementById(e);i&&r&&(r.innerHTML=i.innerHTML),this.toggleAddButton(!this.currentVariant.available,window.variantStrings.notify_me);const n=document.getElementById("variant_id").getAttribute("value"),s=document.getElementById("productSelect").querySelector('[value="'+n+'"]').getAttribute("data-sku"),o=document.getElementById("variantSku");void 0!==o&&o&&(o.innerHTML=s),Currency.convertAll(shopCurrency,$("#currencies span.selected").attr("data-currency"))}))}toggleAddButton(t=!0,e,a=!0){const r=document.getElementById(`product-form-${this.dataset.section}`);if(!r)return;const i=r.querySelector('[name="add"]'),n=r.querySelector('[name="add"] > #AddToCartText'),s=r.querySelector(".product-form__item--submit"),o=r.querySelector(".product-form__item--checkout");if(i)if(t){if(e&&s.setAttribute("data-toggle","modal"),e&&s.setAttribute("data-target","#Form_newletter"),e&&s.classList.add("soldout"),e&&(n.textContent=e),!o)return;o.setAttribute("disabled",!0)}else{const t=document.getElementById("variant_id").getAttribute("value"),e=document.getElementById("productSelect").querySelector('[value="'+t+'"]').getAttribute("data-qty");if(n.textContent=e<1?window.variantStrings.preorder:window.variantStrings.addToCart,s.classList.remove("soldout"),s.removeAttribute("data-toggle"),s.removeAttribute("data-target"),!o)return;o.removeAttribute("disabled")}}setUnavailable(){const t=document.getElementById(`product-form-${this.dataset.section}`)?.querySelector('[name="add"]'),e=t.querySelector("#AddToCartText");t&&(e.textContent=window.variantStrings.unavailable)}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}}customElements.define("variant-selects",VariantSelects);class VariantRadios extends VariantSelects{constructor(){super()}setInputAvailability(t,e){t.forEach((t=>{e.includes(t.getAttribute("value"))?t.classList.remove("disabled"):t.classList.add("disabled")}))}updateOptions(){const t=Array.from(this.querySelectorAll("fieldset"));this.options=t.map((t=>Array.from(t.querySelectorAll("input")).find((t=>t.checked)).value))}}customElements.define("variant-radios",VariantRadios);class VariantSelectsStick extends VariantSelects{constructor(){super()}updateVariantInput(){document.querySelectorAll(`#product-form-sticky-${this.dataset.section}`).forEach((t=>{const e=t.querySelector('input[name="id"]');e.value=this.currentVariant.id,e.dispatchEvent(new Event("change",{bubbles:!0}))}))}renderProductInfo(){fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.section}`).then((t=>t.text())).then((t=>{const e=`ProductPriceStick-${this.dataset.section}`,a=(new DOMParser).parseFromString(t,"text/html"),r=document.getElementById(e),i=a.getElementById(e);i&&r&&(r.innerHTML=i.innerHTML),this.toggleAddButton(!this.currentVariant.available,window.variantStrings.notify_me)}))}toggleAddButton(t=!0,e,a=!0){const r=document.getElementById(`product-form-sticky-${this.dataset.section}`);if(!r)return;const i=r.querySelector('[name="add"]'),n=r.querySelector('[name="add"] > #AddToCartText'),s=r.querySelector(".product-form__item--submit"),o=r.querySelector(".product-form__item--checkout");if(i)if(t){if(e&&s.setAttribute("data-toggle","modal"),e&&s.setAttribute("data-target","#Form_newletter"),e&&s.classList.add("soldout"),e&&(n.textContent=e),!o)return;o.setAttribute("disabled",!0)}else{const t=document.getElementById("variant_id").getAttribute("value"),e=document.getElementById("productSelect").querySelector('[value="'+t+'"]').getAttribute("data-qty");if(n.textContent=e<1?window.variantStrings.preorder:window.variantStrings.addTobag,s.classList.remove("soldout"),s.removeAttribute("data-toggle"),s.removeAttribute("data-target"),!o)return;o.removeAttribute("disabled")}}setUnavailable(){const t=document.getElementById(`product-form-sticky-${this.dataset.section}`)?.querySelector('[name="add"]'),e=t.querySelector("#AddToCartText");t&&(e.textContent=window.variantStrings.unavailable)}}customElements.define("variant-selects-stick",VariantSelectsStick);
